<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Card Generator</title>
    <style>
        @media print {
            .bingo-card {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            }
            body * {
                visibility: hidden;
            }
            #bingoCardsContainer, #bingoCardsContainer * {
                visibility: visible;
            }
            #bingoCardsContainer {
                position: absolute;
                left: 0;
                top: 0;
            }
        }
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .bingo-card {
            display: inline-block;
            margin: 10px;
            padding: 10px;
            border: 2px solid #000;
            /*width: 210mm;*/ /* A4 width */
            /*height: 297mm;*/ /* A4 height */
            width: 8.5in; /* Letter width */
            height: 11in; /* Letter height */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        .bingo-card table {
            width: 100%;
            height: 100%;
            border-collapse: collapse;
        }
        .bingo-card th, .bingo-card td {
            border: 1px solid #000;
            width: 20%;
            height: 20%;
            text-align: center;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <h1>Bingo Card Generator</h1>
    <label for="sheetCount">Number of Sheets:</label>
    <input type="number" id="sheetCount" value="1" min="1">
    <br><br>
    <label for="paperSize">Paper Size:</label>
    <select id="paperSize" onchange="updatePaperSize()">
        <option value="letter">Letter (8.5in x 11in)</option>
        <option value="a4">A4 (210mm x 297mm)</option>
        <option value="custom">Custom</option>
    </select>
    <div id="customSizeInputs" style="display: none;">
        <label for="customWidth">Width:</label>
        <input type="text" id="customWidth" placeholder="e.g., 8.5in or 210mm">
        <label for="customHeight">Height:</label>
        <input type="text" id="customHeight" placeholder="e.g., 11in or 297mm">
    </div>
    <br><br>

    <label for="backgroundImage">Upload Background Image:</label>
    <input type="file" id="backgroundImage" accept="image/*">
    <br><br>
    <button onclick="generateBingoCards()">Generate Bingo Cards</button>
    <button onclick="window.print()">Print</button>
    <div id="bingoCardsContainer"></div>

    <script>
        function generateBingoCards() {
            const sheetCount = document.getElementById('sheetCount').value;
            const backgroundImage = document.getElementById('backgroundImage').files[0];
            const container = document.getElementById('bingoCardsContainer');
            container.innerHTML = '';

            for (let i = 0; i < sheetCount; i++) {
                const card = document.createElement('div');
                card.className = 'bingo-card';
                if (backgroundImage) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        card.style.backgroundImage = `url(${e.target.result})`;
                    }
                    reader.readAsDataURL(backgroundImage);
                }
                card.appendChild(generateBingoTable());
                container.appendChild(card);
            }
        }

        function generateBingoTable() {
            const table = document.createElement('table');
            const header = ['B', 'I', 'N', 'G', 'O'];
            const numbers = Array.from({ length: 75 }, (_, i) => i + 1);
            shuffleArray(numbers);

            const thead = document.createElement('thead');
            const tr = document.createElement('tr');
            header.forEach(letter => {
                const th = document.createElement('th');
                th.textContent = letter;
                tr.appendChild(th);
            });
            thead.appendChild(tr);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            for (let i = 0; i < 5; i++) {
                const tr = document.createElement('tr');
                for (let j = 0; j < 5; j++) {
                    const td = document.createElement('td');
                    if (i === 2 && j === 2) {
                        td.textContent = 'FREE';
                    } else {
                        td.textContent = numbers.pop();
                    }
                    tr.appendChild(td);
                }
                tbody.appendChild(tr);
            }
            table.appendChild(tbody);

            return table;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function updatePaperSize() {
            const paperSize = document.getElementById('paperSize').value;
            const customSizeInputs = document.getElementById('customSizeInputs');
            const bingoCards = document.getElementsByClassName('bingo-card');

            if (paperSize === 'letter') {
                customSizeInputs.style.display = 'none';
                for (let card of bingoCards) {
                    card.style.width = '8.5in';
                    card.style.height = '11in';
                }
            } else if (paperSize === 'a4') {
                customSizeInputs.style.display = 'none';
                for (let card of bingoCards) {
                    card.style.width = '210mm';
                    card.style.height = '297mm';
                }
            } else if (paperSize === 'custom') {
                customSizeInputs.style.display = 'block';
                const customWidth = document.getElementById('customWidth').value;
                const customHeight = document.getElementById('customHeight').value;
                for (let card of bingoCards) {
                    card.style.width = customWidth;
                    card.style.height = customHeight;
                }
            }
        }

        document.getElementById('customWidth').addEventListener('input', updatePaperSize);
        document.getElementById('customHeight').addEventListener('input', updatePaperSize);
    </script>
</body>
</html>